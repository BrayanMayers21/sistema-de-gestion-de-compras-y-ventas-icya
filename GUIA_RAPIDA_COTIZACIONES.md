# ğŸ“‹ GuÃ­a de ImportaciÃ³n Excel - Cotizaciones Antamina

## ğŸ¯ Formato Simplificado

El nuevo formato del Excel es mucho mÃ¡s simple y directo:

### âœ… Estructura del Archivo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PROVEEDOR:   â”‚ Distribuidora de Materiales S.A.C.   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Nombre Producto                â”‚ Cantidad â”‚Precio Unit. â”‚  Subtotal   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cemento Portland Tipo I        â”‚    50    â”‚    28.50    â”‚  1,425.00   â”‚
â”‚ Arena Gruesa m3                â”‚   100    â”‚    45.00    â”‚  4,500.00   â”‚
â”‚ Ladrillos King Kong 18 huecos  â”‚   500    â”‚     0.85    â”‚    425.00   â”‚
â”‚ Fierro Corrugado 1/2" x 9m     â”‚   200    â”‚    32.50    â”‚  6,500.00   â”‚
â”‚ Tubo PVC 2" x 3m               â”‚    75    â”‚    12.00    â”‚    900.00   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL:                                                   â”‚ 13,750.00   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Instrucciones de Uso

### 1ï¸âƒ£ Descargar la Plantilla

1. Ir a **Cotizaciones Antamina**
2. Click en **"Importar Excel"**
3. Click en **"Descargar Plantilla"**
4. Se descargarÃ¡ un archivo Excel con 3 hojas:
   - **CotizaciÃ³n**: Para ingresar datos
   - **Instrucciones**: GuÃ­a de uso
   - **Productos Disponibles**: Lista de productos

### 2ï¸âƒ£ Llenar la Plantilla

#### ğŸ”¸ Paso 1: Ingresar Proveedor

- En la celda **B1** (amarilla), escribir el nombre del proveedor
- Ejemplo: "Distribuidora de Materiales S.A.C."

#### ğŸ”¸ Paso 2: Ingresar Productos

Desde la fila 4 en adelante, ingresar:

| Columna | QuÃ© Ingresar                             | Ejemplo                            |
| ------- | ---------------------------------------- | ---------------------------------- |
| **A**   | Nombre del producto (debe existir en BD) | "Cemento Portland Tipo I x 42.5kg" |
| **B**   | Cantidad                                 | 50                                 |
| **C**   | Precio Unitario                          | 28.50                              |
| **D**   | Subtotal (calculado automÃ¡ticamente)     | =B4\*C4                            |

**âš ï¸ IMPORTANTE:**

- Los nombres de productos deben coincidir con los de la base de datos
- Consulta la hoja "Productos Disponibles" para ver los nombres exactos
- Las columnas NO requieren cÃ³digo, solo el nombre del producto
- El subtotal se calcula automÃ¡ticamente con la fÃ³rmula

### 3ï¸âƒ£ Importar el Archivo

1. Guardar el archivo Excel
2. En la pÃ¡gina, click en **"Importar Excel"**
3. Arrastrar o seleccionar el archivo
4. Click en **"Subir Excel"**
5. Esperar confirmaciÃ³n

## âœ… Ventajas del Nuevo Formato

- âœ¨ **MÃ¡s Simple**: Solo necesitas el nombre del producto, no cÃ³digos
- âš¡ **MÃ¡s RÃ¡pido**: Menos columnas para llenar
- ğŸ¯ **Un Proveedor**: Una cotizaciÃ³n por archivo
- ğŸ”¢ **CÃ¡lculo AutomÃ¡tico**: Subtotales y total se calculan solos
- ğŸ“Š **Visual**: Formato claro tipo factura

## ğŸ” Validaciones

El sistema valida:

âœ“ Proveedor obligatorio (celda B1)  
âœ“ Nombre de producto existe en base de datos  
âœ“ Cantidad es nÃºmero entero > 0  
âœ“ Precio es nÃºmero >= 0  
âœ“ Formato de archivo (xlsx/xls)  
âœ“ TamaÃ±o mÃ¡ximo 5 MB

## ğŸ“Š Resultado

DespuÃ©s de importar, se crearÃ¡:

```json
{
  "success": true,
  "message": "CotizaciÃ³n importada exitosamente",
  "numero_cotizacion": "COT-000015",
  "proveedor": "Distribuidora de Materiales S.A.C.",
  "total_productos": 5,
  "costo_total": 13750.0
}
```

## ğŸ¨ CaracterÃ­sticas del Excel

### Celdas con Colores:

- ğŸŸ¡ **Amarillo**: Campo de proveedor (obligatorio)
- ğŸ”µ **Azul**: Encabezados de columnas
- âšª **Gris**: Filas de ejemplo (pueden eliminarse)
- ğŸŸ¢ **Verde**: Fila de TOTAL

### FÃ³rmulas Incluidas:

- **Subtotal**: `=B4*C4` (cantidad Ã— precio)
- **Total**: `=SUM(D4:D100)` (suma de subtotales)

## ğŸš« Errores Comunes

### âŒ "El producto 'XXX' no existe"

**SoluciÃ³n**: Verifica el nombre exacto en la hoja "Productos Disponibles"

### âŒ "Debe ingresar el proveedor en B1"

**SoluciÃ³n**: AsegÃºrate de llenar la celda B1 con el nombre del proveedor

### âŒ "La cantidad debe ser un nÃºmero"

**SoluciÃ³n**: Ingresa solo nÃºmeros en la columna Cantidad (sin texto)

## ğŸ“ Soporte

Revisa los logs en: `RedBack/storage/logs/laravel.log`

---

**Ãšltima actualizaciÃ³n**: Diciembre 2024  
**VersiÃ³n**: 2.0.0 (Formato Simplificado)
